import tkinter as tk
from game_state import game_state
from endings import Endings
from PyQt6.QtCore import Qt

# Файл scenes.py - перелік і базова логіка сцен гри

# Типи сцен
SCENE_PROLOGUE = "prologue"
SCENE_AWAKENING = "awakening" 
SCENE_MEETING = "meeting"
SCENE_MAIN_MENU = "main_menu"

# Послідовність сцен
SCENE_SEQUENCE = [
    SCENE_PROLOGUE,
    SCENE_AWAKENING,
    SCENE_MEETING
]

# Дані сцен
SCENE_DATA = {
    SCENE_PROLOGUE: {
        "texts": [
            "Погаси борг.\nАбо стань частиною системи.",
            "Ти погодився.\nТвоя воля більше не враховується.",
            "Починаємо..."
        ],
        "skip_key": Qt.Key.Key_K
    },
    SCENE_AWAKENING: {
        "texts": [
            "Пробудження",
            "Темрява. Тиша. Потім - звук. Далекий, металевий. Як капання води у порожньому резервуарі. Ритмічне. Майже нав'язливе. І саме воно витягує тебе з небуття.",
            "Оповідач: Ти відкриваєш очі.\n\nНавколо - бетон. Стеля, підлога, стіни. Одна лампа на стелі. Мерехтлива, наче на межі розрядження. Її світло жовте і холодне водночас.\n\nТи лежиш. Руки - немов чужі. Тіло - занімілі м'язи, наче не твої. На тобі одяг: простий, сірий, без розмірника. Ні кишень. Ні шнурків на черевиках. Як у в'язниці. Як у моргу.",
            "Ти не вдома. Ти не на волі. Ти навіть не в безпеці.",
            "Оповідач: У центрі кімнати - старий монітор. Його корпус, ніби старий хребет, тягнеться назад, викривлений і важкий. Екран не показує нічого, крім блимаючої зеленої риски. Вона блимає в тиші, ритмічно. Якби вона могла дивитись - вона б дивилась прямо на тебе."
        ],
        "italic_texts": [
            "Темрява. Тиша. Потім - звук. Далекий, металевий. Як капання води у порожньому резервуарі. Ритмічне. Майже нав'язливе. І саме воно витягує тебе з небуття.",
            "Ти не вдома. Ти не на волі. Ти навіть не в безпеці."
        ],
        "choice_texts": {
            1: "Оповідач: Ти підходиш ближче. Монітор пищить - короткий, металевий звук, як у зламаної касової машини.",
            2: "Оповідач: Ти обводиш поглядом кімнату. Прямокутне приміщення, приблизно 6 на 6 метрів. Камери в кутках. Дверей немає. На стіні - графіті: щось подряпане нігтями.",
            3: "Оповідач: Ти заплющуєш очі. Робиш вдих. Змушуєш себе повірити, що це сон. Що це пройде."
        },
        "choice_aftermath_texts": {
            2: "Оповідач: Ти чуєш звук з вентиляції. Звідти - чутно ледь чутний голос. Ти мимоволі задумуєшся: Хтось ще є?",
            3: "Пройшло кілька секунд...\nЩось дихає тобі в обличчя..."
        },
        "choice_italic_texts": {
            2: "Раптом монітор вмикається.",
            3: "Голос. Хрипкий. Немеханічний."
        },
        "graffiti_texts": {
            2: "«НЕ ДИВИСЬ НАЗАД»"
        },
        "jumping_red_texts": {
            3: "Ми любимо тих, хто здається першим. Ти зручний. Ламкий. Ти подобаєшся нам хахаха"
        },
        "terminal_text": {
            1: "Вітаю, боржнику. Раді бачити твої очі знову відкритими.\nТи щойно втратив 2 години життя. Ми не повертаємо час.\nТи заборгував 43 770 євро. Ми не повертаємо борги.\nАле ми даруємо шанс.\nВиграєш - отримаєш свободу. Програєш - помреш.\nГрай чесно. Або брудно. Нам байдуже.",
            2: "Пізно. Ти вже тут. Вихід закрито. Починай.",
            3: "Грай, або тебе переграють. Це не симуляція. Це ти."
        },
        "awakening_title_time": 2000,  # Час показу титульного тексту в мс
        "choices": [
            "Підійти до екрана",
            "Озирнутися по кімнаті",
            "Закрити очі та зробити вигляд, що тебе тут немає"
        ]
    },
    SCENE_MEETING: {
        "texts": [
            "Зустріч",
            "Десь у підлозі - клацання. Металеве. Ніби хтось відкриває люк. Тиша на мить стає ще глибшою, а потім...",
            "Оповідач: Вона виходить із тіні. Тиха. Її рухи обережні, як у людини, що вже не вірить у безпечні місця. Дівчина. Середнього зросту, темне волосся, руки в крові, пальці трохи тремтять. Але очі - нерухомі. Вони бачать тебе і не кліпають.",
            "Дівчина: Ти новий? Не говори нічого. Якщо не довіряєш - мовчи. Це може тебе врятувати.",
            "Оповідач: Вона прислухається до вентиляції. Пауза. Потім знову повертається до тебе.",
            "Дівчина: Слухай. Тут усе - брехня. Навіть те, що справжнє. Але найгірше - не інші. Найгірше - та, що за екраном. Вона грається з нами. З тобою. І з тим, ким ти станеш."
        ],
        "italic_texts": [
            "Десь у підлозі - клацання. Металеве. Ніби хтось відкриває люк. Тиша на мить стає ще глибшою, а потім...",
            "За спиною дівчини знову увімкнувся монітор"
        ],
        "choice_texts": {
            1: "Оповідач: Вона зводить брову.",
            2: "Оповідач: Вона опускає погляд. Потім злегка посміхається.",
            3: "Оповідач: Вона мовчить. Потім тихо каже:",
            4: "Оповідач: Вона довго дивиться, потім підходить ближче, майже впритул."
        },
        "choice_aftermath_texts": {
            1: "Дівчина: Та, хто ще дихає. Цього тут достатньо, щоб мати ім'я.",
            2: "Дівчина: Коли двері зачинені, руки роблять те, що не хочеш пам'ятати. Не всі ми маємо вибір. Деякі вже обрали до тебе.",
            3: "Дівчина: Ти ще не знаєш, що це - гірше.",
            4: "Дівчина: Гарний вибір. Мовчання тут - безпечніше за слова. Але ти не зможеш мовчати вічно."
        },
        "choices": [
            "Хто ти?",
            "Чому твої руки в крові?",
            "Я... радий, що я не сам.",
            "Промовчати й просто кивнути"
        ],
        "terminal_text": {
            "test_choice": "Класна зустріч. Але ми тут не для дружби. Ви обоє ще живі - це тимчасово.\nПерша перевірка розпочнеться через 60 секунд.\nВиберіть - хто піде першим."
        },
        "second_choices": [
            "Я піду",
            "Йди ти",
            "Ми йдемо разом"
        ],
        "second_choice_texts": {
            1: "Оповідач: Дівчина киває.",
            2: "Оповідач: Вона дивиться довго. Без емоцій.",
            3: "Оповідач: Монітор блимає."
        },
        "second_choice_aftermath_texts": {
            1: "Дівчина: Твоя хоробрість нічого не доведе. Але без жертв - ніхто не вийде.",
            2: "Дівчина: Зрозуміло. Ти, мабуть, живий за рахунок інших. Звик до цього?",
            3: "Термінал: \"Це не так працює, 'герой'. Одна душа - одне випробування. Але за гарну спробу...\""
        },
        "karma_effects": {
            "second_1": {"responsibility": 1, "game_will_remember": 1},
            "second_2": {"trust": -1, "game_provocation": 1},
            "second_3": {"karma_balance": 1, "trust_in_rules": -1, "future_consideration": 1}
        }
    }
}

# Допоміжна функція для отримання даних сцени
def get_scene_data(scene_id):
    return SCENE_DATA.get(scene_id, {})
